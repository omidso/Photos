function processPage(i){lastWidth=$("#rowholder").innerWidth()-9,$(".picrow").width(lastWidth),$(".picrow").children().remove(),processAlbums(i)}function processAlbums(i){var r=$(".picrow"),h=r.eq(0).innerWidth(),o=220,a=5,t=[];$.each(i,function(i,r){var h=r.width,a=r.height;a!=o&&(h=Math.floor(h*(o/a))),t.push(h)});for(var e=0,n=0,d=t.length;d>0;){n==r.length&&($("#rowholder").append('<div class="picrow"></div>'),$(".picrow").width(h-9),r=$(".picrow"));var c=r.eq(n++);c.children().remove();for(var l=0,p=0;h>l&&d;)l+=t[e+p++]+2*a,d--;var f=1,s=220;d>0&&(f=h/l,s=Math.min(o,Math.floor(o*f)));var v=0;for(l=0;p>v;){var w=i[e+v],g=Math.floor(t[e+v]*f);!function(){var i='<div class="picimage"'+w.data+' style="height:'+s+"px;width:"+g+"px;margin:"+a+"px;background-image:url("+w.imageurl+')"></div>',r=$(i),h=w.linkurl;r.click(function(){location.href=h}),c.append(r),r.append(w.info)}(),l+=g+2*a,v++}for(v=0;h>l&&d>0;){var u=c.find(".picimage:nth-child("+(v+1)+")");u.width(u.width()+1),v=(v+1)%p,l++}for(v=0;l>h-9;){var m=c.find(".picimage:nth-child("+(v+1)+")");m.width(m.width()-1),v=(v+1)%p,l--}c.height(s+2*a),c.show(),e+=p}for(;n<r.length;)r.eq(n++).hide()}var lastWidth=0;